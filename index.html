<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diviner Health Command Center</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container header-content">
            <h1><img src="placeholder-logo.png" alt="Diviner Logo" class="logo"> Diviner</h1>
            <div class="role-switcher">
                <label for="roleSelect">View As:</label>
                <select id="roleSelect">
                    <option value="ayesha" selected>Dr. Ayesha (Public Health)</option>
                    <option value="imran">Imran (Logistics)</option>
                    <option value="leila">Leila (Pharmacist)</option>
                    <option value="faisal">Faisal (Supplier)</option>
                    <option value="reem">Reem (AI Analyst)</option>
                    <option value="loop">System Loop & KPIs</option>
                    <option value="impact">Overall Impact</option>
                </select>
            </div>
        </div>
    </header>

    <main class="container">

        <!-- Dr. Ayesha's View (Public Health Director) -->
        <section id="view-ayesha" class="dashboard-view active-view">
            <div class="dashboard-header">
                <h2>Dr. Ayesha's Dashboard (Public Health Director)</h2>
                <img src="ayesha.png" alt="Dr. Ayesha" class="persona-image">
            </div>
            <div class="grid-container">
                <!-- Heatmap & Outbreak Spike -->
                <div class="card heatmap-card">
                    <h3>Live Outbreak Risk Map & Trends</h3>
                    <div class="heatmap-placeholder">
                        <p><strong><i class="fas fa-sync fa-spin"></i> Loading Alert Status...</strong></p>
                        <div class="map-area simulated-heatmap" id="ayeshaHeatmapArea">
                            <div class="map-loading">[Loading Heatmap Data...]</div>
                        </div>
                        <span class="badge challenge-response">Challenge Response Active</span>
                        <button id="heatmapWhyBtn" class="button info-button">Why?</button>
                    </div>
                    <div class="trend-chart-placeholder">
                        <p>Syndromic Surveillance: Flu Symptoms</p>
                        <div class="chart-area">[Loading Trend Data...]</div>
                        <small>Data Sources: Loading...</small>
                    </div>
                    <div class="feedback-area" id="heatmapWhyFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                </div>

                <!-- Demand Forecast & Strain -->
                <div class="card forecast-card">
                    <h3>Demand Forecast & Operational Strain</h3>
                     <div class="forecast-chart-placeholder">
                        <p>ICU Bed Demand Forecast (Next 7 Days)</p>
                        <div class="chart-area">[Line Chart showing projected ICU demand exceeding capacity within 3 days. Confidence: 85%]</div>
                        <span class="tooltip">Forecast Drivers: High GP report volume, Increased 'fever' mentions online.</span>
                    </div>
                    <div class="strain-warnings">
                        <h4>Operational Strain Warnings (Current)</h4>
                        <div class="strain-item critical-5"><i class="fas fa-users"></i> Staffing: <strong>Critical (5/5)</strong> - High risk of shortage due to sickness & demand.</div>
                        <div class="strain-item critical-3"><i class="fas fa-lungs-virus"></i> Ventilators: <strong>Moderate (3/5)</strong> - Usage increasing, monitor closely.</div>
                        <div class="strain-item critical-2"><i class="fas fa-shield-virus"></i> PPE: <strong>Low (2/5)</strong> - Stock levels currently stable.</div>
                    </div>
                </div>

                <!-- AI Recommendations & Actions -->
                <div class="card recommendations-card">
                    <h3>AI Recommendations</h3>
                    <!-- Recommendation 1: Main Action Plan -->
                    <div class="recommendation-item" id="recItemPlan">
                        <p><strong><i class="fas fa-clipboard-list"></i> Action:</strong> Generate & Approve Health Action Plan for Flu Surge.</p>
                        <p><em>Impact Estimate:</em> Reduce potential hospital overload by 15-20%.</p>
                        <p><em>Confidence:</em> <span style="color: green; font-weight: bold;">High (90%)</span></p>
                        <div class="action-buttons">
                            <button id="viewPlanBtn" class="button button-info"><i class="fas fa-eye"></i> View Plan</button>
                            <button id="approvePlanBtn" class="button button-accept"><i class="fas fa-check"></i> Approve Plan</button>
                            <button id="modifyPlanBtn" class="button button-modify"><i class="fas fa-edit"></i> Modify</button>
                            <button id="declinePlanBtn" class="button button-decline"><i class="fas fa-times"></i> Decline</button>
                        </div>
                        <div class="feedback-area" id="planFeedback" style="margin-top: 5px; font-style: italic; color: #555;"></div>
                    </div>
                    <!-- Recommendation 2: Logistics Alert (Now separate) -->
                     <div class="recommendation-item" id="recItemLogistics">
                        <p><strong><i class="fas fa-truck"></i> Action:</strong> Alert regional logistics (Imran) for potential stock redistribution.</p>
                         <p><em>Impact Estimate:</em> Ensure >95% pharmacy stock availability in high-risk zones (Deira).</p>
                         <p><em>Confidence:</em> <span style="color: orange; font-weight: bold;">Medium (75%)</span></p>
                        <div class="action-buttons">
                            <!-- Note: This button is now primarily informational if approval triggers Imran -->
                            <button id="sendLogisticsAlertBtn" class="button button-accept"><i class="fas fa-paper-plane"></i> Send Alert Now</button>
                            <button id="dismissLogisticsBtn" class="button button-decline"><i class="fas fa-ban"></i> Dismiss</button>
                        </div>
                         <div class="feedback-area" id="logisticsFeedback" style="margin-top: 5px; font-style: italic; color: #555;"></div>
                    </div>
                    <!-- Recommendation 3: Public Awareness Campaign -->
                    <div class="recommendation-item" id="recItemAwareness">
                        <p><strong><i class="fas fa-bullhorn"></i> Action:</strong> Initiate targeted public awareness campaign (SMS/Social Media) in Deira regarding hygiene and symptom checking.</p>
                        <p><em>Impact Estimate:</em> Reduce transmission rate by 5-10%.</p>
                        <p><em>Confidence:</em> <span style="color: orange; font-weight: bold;">Medium (70%)</span></p>
                        <div class="action-buttons">
                            <button id="initiateCampaignBtn" class="button button-accept"><i class="fas fa-play-circle"></i> Initiate Campaign</button>
                            <button id="scheduleCampaignBtn" class="button button-modify"><i class="fas fa-calendar-alt"></i> Schedule Later</button>
                            <button id="declineCampaignBtn" class="button button-decline"><i class="fas fa-times"></i> Decline</button>
                        </div>
                        <div class="feedback-area" id="campaignFeedback" style="margin-top: 5px; font-style: italic; color: #555;"></div>
                    </div>
                    <!-- Recommendation 4: School Advisory -->
                     <div class="recommendation-item" id="recItemSchools">
                        <p><strong><i class="fas fa-school"></i> Action:</strong> Issue advisory to schools in high-risk zones regarding enhanced screening protocols.</p>
                        <p><em>Impact Estimate:</em> Early detection increase by 10-15% in school-age children.</p>
                        <p><em>Confidence:</em> <span style="color: green; font-weight: bold;">High (85%)</span></p>
                        <div class="action-buttons">
                            <button id="issueAdvisoryBtn" class="button button-accept"><i class="fas fa-paper-plane"></i> Issue Advisory</button>
                            <button id="reviewAdvisoryBtn" class="button button-modify"><i class="fas fa-edit"></i> Review/Modify</button>
                            <button id="declineAdvisoryBtn" class="button button-decline"><i class="fas fa-times"></i> Decline</button>
                        </div>
                         <div class="feedback-area" id="advisoryFeedback" style="margin-top: 5px; font-style: italic; color: #555;"></div>
                    </div>

                    <div class="learning-indicator">
                        <p><i class="fas fa-brain"></i> Model updated 2 hours ago based on latest GP data & social media trends.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Imran's View (Logistics Manager) -->
        <section id="view-imran" class="dashboard-view">
            <div class="dashboard-header">
                <h2>Imran's Dashboard (Regional Logistics Manager)</h2>
                <img src="imran.png" alt="Imran" class="persona-image">
            </div>
             <div class="grid-container">
                 <div class="card stock-card">
                     <h3>Inventory & Forecast (Flu Meds - Deira Hub)</h3>
                     <p><strong id="imranAlertMessage"><i class="fas fa-info-circle"></i> ALERT:</strong> Awaiting instructions from Public Health Authority.</p>
                     <div class="stock-comparison">
                         <div>
                             <h4>Current Stock</h4>
                             <p>Flu Vaccine: 1,500 units</p>
                             <p>Antivirals (Oseltamivir): 800 units</p>
                         </div>
                         <div>
                             <h4>Forecasted Need (Next 48h)</h4>
                             <p>Flu Vaccine: <strong style="color: red;">5,000 units</strong></p>
                             <p>Antivirals (Oseltamivir): <strong style="color: red;">3,000 units</strong></p>
                         </div>
                     </div>
                     <p id="imranShortfallMessage" style="margin-top: 1rem; color: grey; font-weight: normal;">Projected Shortfall: TBD</p>
                     <div class="card-actions">
                         <button id="imranViewStockDetailsBtn" class="button"><i class="fas fa-list-alt"></i> View Details</button>
                         <button id="imranAdjustThresholdsBtn" class="button"><i class="fas fa-sliders-h"></i> Adjust Thresholds</button>
                     </div>
                     <div class="feedback-area" id="imranStockFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                 </div>

                 <div class="card route-card">
                     <h3>AI Recommended Redistribution</h3>
                     <p id="imranActionMessage">Awaiting plan approval to calculate optimal routes.</p>
                     <div class="route-placeholder simulated-route-map" id="imranRouteDetails">
                         <div class="map-loading">[Route Map Placeholder...]</div>
                     </div>
                     <div class="action-buttons">
                         <button id="confirmDispatchBtn" class="button button-accept" disabled><i class="fas fa-check"></i> Confirm Route & Dispatch</button>
                         <button id="modifyDispatchBtn" class="button button-modify" disabled><i class="fas fa-pencil-alt"></i> Adjust Quantities/Route</button>
                     </div>
                 </div>

                 <div class="card reallocation-card">
                     <h3>Inventory Reallocation Status</h3>
                     <div class="status-item">
                         <p><strong>Shipment ID:</strong> #FLU-DXB-001</p>
                         <p><strong>From:</strong> Al Ain Depot</p>
                         <p><strong>To:</strong> Deira Hub</p>
                         <p><strong>Contents:</strong> Flu Vaccines (4k), Antivirals (2.5k)</p>
                         <p><strong>Status:</strong> <span id="shipmentStatus" class="status-pending"><i class="fas fa-hourglass-start"></i> Awaiting Plan Approval</span></p>
                     </div>
                     <!-- Add more status items as needed -->
                 </div>

                 <!-- New Activity Log Card -->
                 <div class="card activity-log-card">
                     <h3>Public Health Activity Log</h3>
                     <ul id="imranActivityLog">
                         <li><i class="fas fa-history"></i> Monitoring initiated...</li>
                         <!-- Log entries will be added here by JS -->
                     </ul>
                 </div>
            </div>
        </section>

        <!-- Leila's View (Community Pharmacist) -->
        <section id="view-leila" class="dashboard-view">
            <div class="dashboard-header">
                <h2>Leila's Dashboard (Community Pharmacist)</h2>
                <img src="leila.png" alt="Leila" class="persona-image">
            </div>
            <div class="grid-container single-column">
                <div class="card notification-card">
                    <h3>Notifications & Alerts</h3>
                    <div id="leilaUrgentAlertContainer" class="alert-item info" style="display: none;"> <!-- Initially hidden -->
                        <p id="leilaUrgentAlertText">...</p>
                        <small id="leilaUrgentAlertTime">Received: ...</small>
                    </div>
                     <div class="alert-item info">
                        <p><strong><i class="fas fa-info-circle"></i> INFO:</strong> AI suggests promoting preventive flu measures (masks, sanitizers) due to high community transmission indicators.</p>
                        <small>Received: 1 hour ago</small>
                    </div>
                     <div id="leilaConfirmationMsg" style="color: green; margin-top: 10px; font-weight: bold;"></div>
                </div>

                <div class="card local-forecast-card">
                    <h3>Local Demand Forecast (Your Pharmacy - Next 24h)</h3>
                    <div class="forecast-chart-placeholder">
                        <p>Demand for Flu-Related Meds & Items</p>
                        <div class="chart-area">[Simple Bar Chart: Antivirals +300%, Vaccines +250%, Masks +150%, Sanitizers +100%]</div>
                    </div>
                </div>

                <div class="card suggestions-card">
                    <h3>AI Recommendations for Pharmacy</h3>
                    <p><strong><i class="fas fa-box-open"></i> Suggestion:</strong> Prepare storage space for incoming delivery (approx. 6 large crates).</p>
                    <p><strong><i class="fas fa-store"></i> Suggestion:</strong> Set up promotional display for Vitamin C and sanitizers near entrance to capture increased footfall.</p>
                    <div class="action-buttons">
                        <button id="leilaActionedBtn" class="button button-accept" disabled><i class="fas fa-tasks"></i> Mark All as Actioned</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Faisal's View (Supplier Manager) -->
        <section id="view-faisal" class="dashboard-view">
            <div class="dashboard-header">
                <h2>Faisal's Dashboard (Supplier Manager)</h2>
                <img src="faisal.png" alt="Faisal" class="persona-image">
            </div>
             <div class="grid-container">
                 <div class="card national-demand-card">
                     <h3>National Demand Signal</h3>
                     <p id="faisalDemandSignal"><strong><i class="fas fa-chart-line"></i> Signal:</strong> Stable - Monitoring national trends.</p>
                     <div class="chart-area simulated-national-map" id="faisalDemandChartArea">
                         <div class="map-loading">[National Trend Map - Currently Stable]</div>
                     </div>
                     <small>Key Drivers: Awaiting significant outbreak triggers.</small>
                 </div>

                 <div class="card production-card">
                     <h3>Current Production Lines</h3>
                     <p id="faisalProdRecommendation"><strong><i class="fas fa-cogs"></i> AI Recommendation:</strong> Maintain standard production schedule.</p>
                     <ol id="faisalProdQueue">
                         <li>Standard Antibiotic #AB123</li>
                         <li>Pain Relief Med #PR789</li>
                         <li>Routine Stock Replenishment</li>
                         <!-- Flu meds will be added dynamically -->
                     </ol>
                     <div class="card-actions">
                         <button id="faisalAutoAdjustToggle" class="button button-toggle"><i class="fas fa-robot"></i> Auto-adjust: OFF</button>
                         <button id="faisalViewProdDetailsBtn" class="button"><i class="fas fa-list-alt"></i> View Details</button>
                         <button id="faisalManualOverrideBtn" class="button button-warning"><i class="fas fa-user-cog"></i> Manual Override</button>
                     </div>
                     <div class="feedback-area" id="faisalProdFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                 </div>

                 <div class="card material-stock-card">
                     <h3>Raw Material Stock</h3>
                     <p><strong><i class="fas fa-industry"></i> Status:</strong> Raw material orders for prioritized batches confirmed.</p>
                     <p><strong><i class="fas fa-shipping-fast"></i> Logistics:</strong> Outbound shipping capacity reserved for anticipated distribution needs.</p>
                     <div class="card-actions">
                         <button id="faisalViewSuppliersBtn" class="button"><i class="fas fa-users"></i> View Suppliers</button>
                         <button id="faisalPlaceMaterialOrderBtn" class="button button-accept"><i class="fas fa-shopping-cart"></i> Place Order</button>
                     </div>
                      <div class="feedback-area" id="faisalMaterialFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                 </div>

                 <div class="card priority-queue-card">
                     <!-- ... Production Priority Queue (no buttons here) ... -->
                 </div>
             </div>
        </section>

        <!-- Reem's View (AI & Data Analyst) -->
        <section id="view-reem" class="dashboard-view">
            <div class="dashboard-header">
                <h2>Reem's Dashboard (AI & Data Analyst)</h2>
                <img src="reem.png" alt="Reem" class="persona-image">
            </div>
            <div class="grid-container">
                <div class="card simulation-card">
                    <h3>Model Simulation & Tuning</h3>
                    <p>Simulate impact of different response strategies or data inputs.</p>
                    <div class="card-actions">
                        <button id="reemRunSimulationBtn" class="button button-accept"><i class="fas fa-play"></i> Run Simulation</button>
                        <button id="reemCompareModelsBtn" class="button"><i class="fas fa-exchange-alt"></i> Compare Models</button>
                    </div>
                     <div class="feedback-area" id="reemSimFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                </div>

                <div class="card deployment-card">
                    <h3>Model Deployment</h3>
                    <p>Current Model: <strong>FluNet-v3.1 (Accuracy: 92.5%)</strong></p>
                    <div class="card-actions">
                        <button id="reemDeployUpdateBtn" class="button button-accept"><i class="fas fa-cloud-upload-alt"></i> Deploy Update</button>
                        <button id="reemRollbackBtn" class="button button-decline"><i class="fas fa-undo"></i> Rollback</button>
                    </div>
                     <div class="feedback-area" id="reemDeployFeedback" style="margin-top: 5px; font-style: italic; color: #555; display: none;"></div>
                </div>

                <div class="card retraining-card">
                    <h3>Model Retraining</h3>
                    <p><strong><i class="fas fa-vial"></i> Insight:</strong> Social media sentiment analysis (specifically 'fever' + 'Deira' mentions) was highly predictive (Weight: 0.75) for this event's early detection.</p>
                    <div class="tuning-controls">
                        <p>Adjust model parameters for next learning cycle:</p>
                        <label>GP Data Weight: <input type="range" min="0" max="1" step="0.05" value="0.8"> (0.80)</label><br>
                        <label>Social Media Weight: <input type="range" min="0" max="1" step="0.05" value="0.75"> (0.75)</label><br>
                        <label>Hospital Admission Weight: <input type="range" min="0" max="1" step="0.05" value="0.6"> (0.60)</label><br>
                        <div class="action-buttons">
                            <button id="retrainModelBtn" class="button button-accept"><i class="fas fa-save"></i> Apply Changes & Retrain</button>
                        </div>
                         <div id="retrainConfirmationMsg" style="color: green; margin-top: 10px; font-weight: bold;"></div>
                    </div>
                </div>

                <div class="card learning-timeline-card">
                    <h3>Learning Timeline & Accuracy</h3>
                     <div class="timeline-placeholder">
                        <p>Model Predictive Accuracy Over Time</p>
                        <div class="chart-area">[Line chart showing accuracy improving from 70% to 92% over last 6 months]</div>
                        <p id="lastRetrainingTime"><i class="fas fa-history"></i> Last Retraining: <strong>1 day ago</strong>.</p>
                        <p><i class="fas fa-check-circle"></i> Current Accuracy (Short-term Forecast): <strong>92.5%</strong></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- NEW: System Loop & KPIs View -->
        <section id="view-loop" class="dashboard-view">
            <h2>System Loop & Key Performance Indicators</h2>
            <p>Diviner orchestrates a continuous cycle of perception, reasoning, action, and learning across all stakeholders, breaking down silos and accelerating response.</p>
            <div class="grid-container">
                <div class="card loop-diagram-card">
                    <h3>The Diviner Agentic Loop</h3>
                    <div class="loop-diagram-placeholder">
                        <p>[Animated Diagram Placeholder]</p>
                        <div class="loop-text">
                            <span class="loop-step perceive"><i class="fas fa-eye"></i> Perceive (Data Ingestion)</span> &rarr;
                            <span class="loop-step reason"><i class="fas fa-brain"></i> Reason (AI Analysis & Recs)</span> &rarr;
                            <span class="loop-step act"><i class="fas fa-play"></i> Act (Stakeholder Actions)</span> &rarr;
                            <span class="loop-step learn"><i class="fas fa-sync-alt"></i> Learn (Model Retraining)</span> &rarr; (Loop)
                        </div>
                         <p style="margin-top: 1rem; font-style: italic;">This cycle involves Dr. Ayesha, Imran, Leila, Faisal, and Reem, each guided by AI insights relevant to their role.</p>
                    </div>
                </div>
                <div class="card kpi-card">
                    <h3>Performance Impact (vs. Baseline)</h3>
                    <ul class="kpi-list">
                        <li class="kpi-item shortages">
                            <i class="fas fa-ban"></i>
                            <div>
                                <strong>Shortages Prevented:</strong>
                                <span class="kpi-value" id="kpiShortages">98%</span>
                            </div>
                        </li>
                        <li class="kpi-item response-time">
                            <i class="fas fa-shipping-fast"></i>
                            <div>
                                <strong>Response Time Improvement:</strong>
                                <span class="kpi-value" id="kpiResponseTime">3x Faster</span>
                            </div>
                        </li>
                        <li class="kpi-item wastage">
                            <i class="fas fa-recycle"></i>
                            <div>
                                <strong>Stock Wastage Reduction:</strong>
                                <span class="kpi-value" id="kpiWastage">60%</span>
                            </div>
                        </li>
                         <li class="kpi-item collaboration">
                            <i class="fas fa-users"></i>
                            <div>
                                <strong>Cross-Functional Efficiency:</strong>
                                <span class="kpi-value" id="kpiEfficiency">High</span>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- NEW: Overall Impact View -->
        <section id="view-impact" class="dashboard-view">
            <h2>Overall Impact Assessment</h2>
            <p>By optimizing the healthcare logistics chain, Diviner contributes to significant positive outcomes.</p>
             <div class="grid-container">
                 <div class="card impact-card cost-savings">
                     <h3><i class="fas fa-dollar-sign"></i> Healthcare Cost Savings</h3>
                     <div class="impact-chart-placeholder" id="impactChartCost">
                         [Calculating...]
                     </div>
                     <p>Estimated annual savings: <strong>Significant</strong> (Quantification pending full-scale deployment)</p>
                 </div>
                  <div class="card impact-card lives-impacted">
                     <h3><i class="fas fa-heartbeat"></i> Lives Positively Impacted</h3>
                      <div class="impact-chart-placeholder" id="impactChartLives">
                         [Calculating...]
                     </div>
                     <p>Focus on timely access to critical medications during surges, improving community health resilience.</p>
                 </div>
                  <div class="card impact-card sustainability">
                     <h3><i class="fas fa-leaf"></i> Sustainability Gains</h3>
                      <div class="impact-chart-placeholder" id="impactChartSustainability">
                         [Calculating...]
                     </div>
                     <p>Optimized logistics and reduced spoilage contribute to a greener supply chain.</p>
                 </div>
             </div>
        </section>

        <!-- Future Features Placeholder -->
        <section class="future-features">
            <h4><i class="fas fa-forward"></i> Coming Soon...</h4>
            <p>Integration with Wearable Data | Pharmacy Chatbot Alerts | Advanced Supply Chain Optimization</p>
        </section>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2023 Diviner Health Solutions. Transforming Healthcare Logistics.</p>
            <p>Built with Agentic AI | <i class="fas fa-eye"></i> Perceive → <i class="fas fa-brain"></i> Reason → <i class="fas fa-play"></i> Act → <i class="fas fa-sync-alt"></i> Learn</p>
        </div>
    </footer>

    <!-- Modal Structure for Viewing Plan -->
    <div id="planModal" class="modal">
        <div class="modal-content">
            <span class="modal-close-button">&times;</span>
            <h3 id="modalTitle">Health Action Plan Details</h3>
            <div id="modalBody">
                <!-- Plan details will be loaded here by JavaScript -->
                <p>Loading plan details...</p>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
